version: 1

frontend:
  phases:
    preBuild:
      commands:
        - nvm install 18
        - nvm use 18

        - corepack enable
        - corepack prepare pnpm@10.28.1 --activate

        # install from repo root
        - pnpm install --frozen-lockfile

    build:
      commands:
        # build only the web app
        - pnpm --filter web build

  artifacts:
    baseDirectory: apps/web/.next
    files:
      - "**/*"

  cache:
    paths:
      - node_modules/**/*
      - .pnpm-store/**/*
      - .turbo/**
